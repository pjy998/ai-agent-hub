name: coding-with-ai
description: AI-driven coding workflow with clarification, implementation, and testing
agents:
  - requirements
  - coder
  - tester

steps:
  - name: clarify
    agent: requirements
    prompt: |
      Analyze the following code context and clarify the requirements:
      
      File: {{file}}
      Language: {{language}}
      Selected Code: {{selection}}
      Git Diff: {{gitDiff}}
      
      Please provide:
      1. Clear understanding of what needs to be implemented
      2. Any questions or clarifications needed
      3. Suggested approach and architecture
      
      Respond in JSON format with: { "clarified": "...", "questions": [...], "approach": "..." }
    output: clarification

  - name: coding
    agent: coder
    prompt: |
      Based on the clarification: {{clarification}}
      
      Generate production-ready code for:
      File: {{file}}
      Language: {{language}}
      Context: {{selection}}
      
      Requirements:
      - Follow best practices and design patterns
      - Include proper error handling
      - Add comprehensive documentation
      - Ensure type safety (if applicable)
      - Consider performance implications
      
      Return only the code in markdown format.
    output: code

  - name: testing
    agent: tester
    prompt: |
      Generate comprehensive tests for the following code:
      {{code}}
      
      File: {{file}}
      Language: {{language}}
      
      Create tests that cover:
      - Happy path scenarios
      - Edge cases and error conditions
      - Input validation
      - Performance considerations
      - Integration scenarios (if applicable)
      
      Use appropriate testing framework for {{language}}.
      Return only the test code in markdown format.
    output: tests